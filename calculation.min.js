function validate(f,a,c,b,e){$(".error").each(function(){$(this).css("visibility","hidden").next().css("border-color","")});$("#result").text("");var d=[];if(isNaN(f)||f<1){d.push("loan_amount")}if(isNaN(a)){a=0;$("#residual_amount").val("0")}else{if(a>f){d.push("residual_amount")}}if(isNaN(b)||(b<2||b>5)){d.push("term")}if(isNaN(c)){d.push("rate")}else{switch(c){case 5:case 5.5:case 6:case 6.5:case 7:case 7.5:case 8:case 8.5:case 9:case 9.5:case 10:case 10.5:case 11:case 11.5:case 12:case 12.5:case 13:case 13.5:case 14:case 14.5:case 15:case 15.5:case 16:break;default:d.push("rate")}}if(isNaN(e)){d.push("frequency")}else{switch(e){case 12:case 32:case 52:break;default:d.push("frequency")}}if(d.length){return d}else{return false}}function addCommas(a){var b=a.toString().split(".");b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return b.join(".")}$(function(){$(".pvt_dec").numeric({separator:",",negative:false});$("#residual_amount").blur(function(){if(!$(this).val()||($(this).val().length==0)){$(this).val("0");$("#residual_percentage").val("0")}else{$(this).trigger("change")}});$("#residual_amount").change(function(){var a=parseFloat($(this).val().split(",").join(""));var b=parseFloat($("#loan_amount").val().split(",").join(""));$("#residual_percentage").val(a/b*100);if(Math.round($("#residual_percentage").val()!=NaN)){$("#residual_percentage").val(parseFloat($("#residual_percentage").val()).toFixed(2))}if(a>b){$(this).css("border-color","red").prev().css("visibility","visible");$("#residual_percentage").css("border-color","red").prev().css("visibility","visible")}});$("#residual_percentage").blur(function(){if(!$(this).val()||($(this).val().length==0)){$(this).val("0");$("#residual_amount").val("0")}});$("#residual_percentage").change(function(){var a=parseFloat($(this).val().split(",").join(""));var b=parseFloat($("#loan_amount").val().split(",").join(""));$("#residual_amount").val(a*b/100);if(Math.round($("#residual_amount").val())!=NaN){$("#residual_amount").val(parseFloat($("#residual_amount").val()).toFixed(2))}if(a>100){$(this).css("border-color","red").prev().css("visibility","visible");$("#residual_amount").css("border-color","red").prev().css("visibility","visible")}});$("#calculate").click(function(j){j.preventDefault();var g=parseFloat($("#loan_amount").val().split(",").join("")),k=parseFloat($("#rate").val()),b=parseFloat($("#term").val()),m=parseFloat($("input[name=frequency]:checked").val());if($("#residual_amount").val().length>0){residual_amount=parseFloat($("#residual_amount").val().split(",").join(""))}var l=validate(g,residual_amount,k,b,m);if(l&&l.length>0){for(var d=0;d<l.length;d++){if(l[d]=="residual_amount"&&$("#residual_amount").val().length==0){$("#residual_amount").val("0");residual_amount=0;continue}$("#"+l[d]).css("border-color","red").prev().css("visibility","visible")}return false}var c=g,o=residual_amount,h=b*m,d=k/12/100;var f=c-o/(Math.pow((1+d),h));var n=(1-(1/Math.pow((1+d),h)))/d;var a=(f/n).toFixed(2);$("#result").text("$ "+addCommas(a))})});